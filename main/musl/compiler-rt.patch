--- a/configure
+++ b/configure
@@ -587,10 +587,15 @@
 tryldflag LDFLAGS_AUTO -Wl,-Bsymbolic-functions
 
 # Find compiler runtime library
+test -z "$LIBCC" && {
+try_libcc=`$CC --rtlib=compiler-rt -print-libgcc-file-name 2>/dev/null`
+tryldflag LIBCC "$try_libcc"
+}
 test -z "$LIBCC" && tryldflag LIBCC -lgcc && tryldflag LIBCC -lgcc_eh
-test -z "$LIBCC" && tryldflag LIBCC -lcompiler_rt
-test -z "$LIBCC" && try_libcc=`$CC -print-file-name=libpcc.a 2>/dev/null` \
-                 && tryldflag LIBCC "$try_libcc"
+test -z "$LIBCC" && {
+try_libcc=`$CC -print-file-name=libpcc.a 2>/dev/null`
+tryldflag LIBCC "$try_libcc"
+}
 printf "using compiler runtime libraries: %s\n" "$LIBCC"
 
 # Figure out arch variants for archs with variants
